# Copy superstate operator info to substate
sp {put-down*elaborate*state
   (state <s> ^superstate <ss>
              ^impasse no-change)
   (<ss> ^operator <o>)
   (<o> ^name put-down
        ^object-id <oid>
        ^target-id <tid>
        ^use-objective <obj>)
-->
   (<s> ^name put-down
        ^held-object <oid>
        ^target-object <tid>
        ^objective <obj>)
}

# Use topstate SVS so that commands can actually be executed
sp {put-down*elaborate*svs
   (state <s> ^superstate <ss>
              ^name put-down)
   (<ss> ^superstate nil
         ^svs <v>)
-->
   (<s> ^topstate-svs <v>)
}

# Logic for deciding when the pick-up should be done
sp {put-down*elaborate*finished-motions
   (state <s> ^name put-down
              ^topstate-svs.command <cmd>)
   (<cmd> ^straight-line-motion <slo>
          ^set-gripper <sg>)
   (<slo> ^status finished)
   (<sg> ^target 0.0
         ^status finished)
-->
   (<s> ^finished-moving true)
}